<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>测试页面</title>
<script type="text/javascript" src="functions/json/json2.js"></script>
<script type="text/javascript">

function addevent()
{
	var ev;
	try
	{
		ev =  "{\"id\":0,\"event_date\":\"2010-11-22\",\"description\":\"事件详情（不超过30个中文字）\",\"repeat\":2,\"alarm\":3,\"status\":1}"
/*
		var test = {};
		test.id = 0;
		test.event_date = "2010-10-21";
		test.description = "adfdasfas";
		var st = JSON.stringify(test)
*/		
		window.external.AddEvent(ev);
	}
	catch(e)
	{
	
	}

}

function deleteevent()
{
	try
	{
		for(i=0;i<100;i++){
			window.external.DeleteEvent(i);
		}
	}
	catch(e)
	{
	}
}

function getevents()
{
	try
	{
		var year = 2010;
		var month = 12;
		
		alert(window.external.GetEvents(year, month));
	}
	catch(e)
	{
	}
}

function geteventsoneday()
{
	try
	{
		var year = 2010;
		var month = 10;
		var day = 22;
		
		alert(window.external.GetEventsOneDay(year, month, day));
	}
	catch(e)
	{
	}
}

function setalarm()
{
	try
	{		
		var alarm = "{\"id\":0,\"status\":2}";
		window.external.SetAlarm(alarm);
	}
	catch(e)
	{
	}
}

function gettodayalarms()
{
	try
	{
		alert(window.external.GetTodayAlarms());
	}
	catch(e)
	{
	}
}


function savecoupon()
{
	try
	{
		var id = 0;
		var expire = "2010-10-11";
		
		window.external.SaveCoupon(id, expire);
	}
	catch(e)
	{
	}
}

function deletecoupon()
{
	try
	{
		var id = 0;		
		window.external.DeleteCoupon(id);
	}
	catch(e)
	{
	}
}

function getcoupons()
{
	try
	{
		alert(window.external.GetCoupons());
	}
	catch(e)
	{
	}
}

function getenv()
{
	try
	{
		alert(window.external.GetEnvironment("%appdata%"));
	}
	catch(e)
	{
	}
}


</script>

<script>
	function show_modal_dialog()
	{
		var obj = new Object();
		obj.name="51js";
		window.showModalDialog("http://www.finantech.cn",obj,"dialogWidth=200px;dialogHeight=100px");
	}
	
	function show_modaless_dialog()
	{
		var obj = new Object();
		obj.name="51js";
		window.showModelessDialog ("http://www.finantech.cn",obj,"dialogWidth=200px;dialogHeight=100px");
	}

</script>


</head>
<body>

<button onClick="addevent();">AddEvent</button>
<button onClick="deleteevent();">DeleteEvent</button>
<button onClick="getevents();">GetEvents</button>
<button onClick="geteventsoneday();">GetEventsOneDay</button>
<br />

<button onClick="setalarm();">SetAlarm</button>
<button onClick="gettodayalarms();">GetTodayAlarms</button>

<br />

<button onClick="savecoupon();">SaveCoupon</button>
<button onClick="deletecoupon();">DeleteCoupon</button>
<button onClick="getcoupons();">GetCoupons</button>

<br />
<button onClick="show_modal_dialog();">ShowModalDialog</button>
<button onClick="show_modaless_dialog();">ShowModalessDialog</button>

<br />
<button onClick="getenv();">GetEnv</button>

</body>
</html>