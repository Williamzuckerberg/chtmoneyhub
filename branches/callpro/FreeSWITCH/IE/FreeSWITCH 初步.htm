<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>FreeSWITCH 初步 - 我的程序人生 - 博客频道 - CSDN.NET</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="什么是 FreeSWITCH ？FreeSWITCH 是一个开源的电话交换平台，它具有很强的可伸缩性–从一个简单的软电话客户端到运营商级的软交换设备几乎无所不能。能原生地运行于Windows、Max OS X、Linux、BSD 及 solaris 等诸多32/64位平台。可以用作一个简单的交换引擎、一个PBX，一个媒体网关或媒体支持IVR的服务器等。它支持SIP、H323、Sky">
<script src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ga.js" async="" type="text/javascript"></script><script src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/jquery.js" type="text/javascript"></script>
<script src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/plugins.js" type="text/javascript"></script>
<script src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/common.js" type="text/javascript"></script>
<link rel="Stylesheet" type="text/css" href="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/style.css">
<link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://blog.csdn.net/qq275683555/rss/list">
<link rel="shortcut icon" href="http://blog.csdn.net/favicon.ico">
<link type="text/css" rel="stylesheet" href="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/default.css">
</head>
<body>
<script src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/pub_topnav_2011.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/navtop_2012.css">
<div class="nav_top_2011">
<p><span style="color:red;">您还未登录！</span>|<a href="http://passport.csdn.net/account/login">登录</a>|<a href="http://passport.csdn.net/account/register">注册</a>|<a href="http://passport.csdn.net/help/faq">帮助</a></p><ul>
<li><a href="http://www.csdn.net/" target="_blank">CSDN首页</a></li>
<li><a href="http://news.csdn.net/" target="_blank">资讯</a></li>
<li><a href="http://bbs.csdn.net/" target="_blank">论坛</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客</a></li>
<li><a href="http://download.csdn.net/" target="_blank">下载</a></li>
<li><a href="http://so.csdn.net/" target="_blank">搜索</a></li>
<li class="more"><h2 id="topnav_btnmore" onclick="showNavMore(this)"><a href="javascript:void(0);">更多</a></h2>
<ul id="topnav_hidlist">
<li><a href="http://cto.csdn.net/" target="_blank">CTO俱乐部</a></li>
<li><a href="http://student.csdn.net/" target="_blank">学生大本营</a></li>
<li><a href="http://edu.csdn.net/" target="_blank">培训充电</a></li>
<li><a href="http://mobile.csdn.net/" target="_blank">移动开发</a></li>
<li><a href="http://sd.csdn.net/" target="_blank">软件研发</a></li>
<li><a href="http://cloud.csdn.net/" target="_blank">云计算</a></li>
<li><a href="http://www.programmer.com.cn/" target="_blank">程序员</a></li>
<li><a href="http://www.iteye.com/" target="_blank">ITeye</a></li>
<li><a href="http://tup.csdn.net/" target="_blank">TUP</a></li>
</ul>
</li>
</ul>
</div>


<div id="container">
<div id="header">
    <div class="header">
        <div id="blog_title">
            <h1>
                <a href="http://blog.csdn.net/qq275683555">我的程序人生</a></h1>
            <h2> </h2>
            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg">
    </div>
    <div class="navigator">
        <ul>
            <!--<li id="btnHome"><a href="/qq275683555"><span><img src="http://static.blog.csdn.net/images/ico_home.gif">我的首页</span></a></li>-->
            <li id="btnContents"><a href="http://blog.csdn.net/qq275683555?viewmode=contents"><span><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ico_list.gif">目录视图</span></a></li>
            <li id="btnView"><a href="http://blog.csdn.net/qq275683555?viewmode=list"><span><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ico_summary.gif">摘要视图</span></a></li>
            <li id="btnRss"><a href="http://blog.csdn.net/qq275683555/rss/list"><span><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ico_rss.gif">订阅</span></a></li>
</ul>
    </div>
</div>
<script type="text/javascript">
    var username = "qq275683555";
    var blog_address = "http://blog.csdn.net/qq275683555";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = $.cookie("UserName");
</script>
        
<div id="body">
<div id="main">
<div class="main">
<div class="notice"> 


<a href="http://blog.csdn.net/blogdevteam/article/details/7568876" target="_blank"><font color="red">精创之作《雷神的微软平台安全宝典》诚邀译者 </font></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://www.mobileasiaexpo.cn/?MAECN=CSDN2" target="_blank"><font color="blue">移动业界领袖会议·上海·6.20</font></a>
<br>
<a href="http://blog.csdn.net/blogdevteam/article/details/7608507" target="_blank"><font color="blue">CSDN博客频道“移动开发之我见”主题征文活动 </font></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://topic.csdn.net/u/20120416/10/9123faba-8474-4f2a-a0cf-a1b7d0fe5913.html" target="_blank"><font color="red">【分享季1】：网友推荐130个经典资源，分享再赠分！</font></a>

</div><script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ad.js"></script>

<div id="article_details" class="details">
    <div class="article_title">
    <span class="ico ico_type_Repost"></span>
    <h3>
        <span class="link_title"><a href="http://blog.csdn.net/qq275683555/article/details/7092085">
        FreeSWITCH 初步
        </a></span>
    </h3>
</div>

        
    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="http://blog.csdn.net/qq275683555/article/category/956910">freeswitch</a> 
        </span>
    <span class="link_postdate">2011-12-21 17:09</span>
    <span class="link_view" title="阅读次数">205人阅读</span>
    <span class="link_comments" title="评论次数"><a href="#comments">评论</a>(0)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:collectArticle('FreeSWITCH 初步','7092085');return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="#report" onclick="javascript:report(7092085,2);return false;" title="举报">举报</a></span>
    
</div>

    
<div id="article_content" class="article_content">
    
<span style="font-family:Tahoma,Helvetica,sans-serif; font-size:10px"></span>
<div class="postH" style="padding-top:0.6em; padding-right:0.6em; padding-bottom:0.6em; padding-left:0.6em; background-color:rgb(247,247,247); border-top-width:1px; border-top-style:solid; border-top-color:rgb(59,89,152); border-bottom-width:1px; border-bottom-style:solid; border-bottom-color:rgb(216,223,234)">
<h1 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(51,51,51); font:normal normal bold 16px/normal 'Microsoft YaHei',Tahoma; line-height:0.8em; padding-top:3px; padding-right:0px; padding-bottom:5px; padding-left:0px; margin-top:0.3em; margin-right:0px; margin-bottom:0.32em; margin-left:0px">
<br>
</h1>
</div>
<div class="postCX" style="padding-top:2px; padding-right:0px; padding-bottom:5px; padding-left:0px; font-size:1.2em; background-color:initial; color:rgb(68,70,64)">
<h1 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
<img class="alignright size-full wp-image-207" title="FS_Book" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/FS_Book.png" alt="" style="padding: 0px; margin: 0px; border-style: none; text-align: center; float: right;" height="152" width="125">什么是
 FreeSWITCH ？</h1>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FreeSWITCH 
是一个开源的电话交换平台，它具有很强的可伸缩性–从一个简单的软电话客户端到运营商级的软交换设备几乎无所不能。能原生地运行于Windows、Max
 OS X、Linux、BSD 及 solaris 
等诸多32/64位平台。可以用作一个简单的交换引擎、一个PBX，一个媒体网关或媒体支持IVR的服务器等。它支持SIP、H323、Skype、
Google Talk等协议，并能很容易地与各种开源的PBX系统如sipXecs、Call 
Weaver、Bayonne、YATE及Asterisk等通信。
 FreeSWITCH 遵循RFC并支持很多高级的SIP特性，如 
presence、BLF、SLA以及TCP、TLS和sRTP等。它也可以用作一个SBC进行透明的SIP代理（proxy）以支持其它媒体如T.38
等。FreeSWITCH 支持宽带及窄带语音编码，电话会议桥可同时支持8、12、16、24、32及48kHZ的语音. 
而在传统的电话网络中，要做到三方通话或多方通话需要通过专门的芯片来处理，其它像预付费，彩铃等业务在PSTN网络中都需要依靠智能网(IN)才能实
现，而且配置起来相当不灵活。</p>
</blockquote>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
快速体验</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
FreeSWITCH 的功能确实非常丰富和强大，在进一步学习之前我们先来做一个完整的体验。FreeSWITCH 默认的配置是一个SOHO 
PBX(家用电话小交换机)，那么我们本章的目标就是从0安装，实现分机互拨电话，测试各种功能，并通过添加一个SIP-PSTN网关拨打PSTN电话。
这样，即使你没有任何使用经验，你也应该能顺利走完本章，从而建立一个直接的认识。在体验过程中，你会遇到一点稍微复杂的配置，如果不能完全理解，也不用
担心，我们在后面会详细的介绍。当然，如果你是一个很有经验的 FreeSWITCH 用户，那么大可跳过本章。</p>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
安装FreeSWITCH基本系统</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
在本文写作时，最新的版本1.0.5pre10，但说不定当你读到时1.0.5正式版已经发布了。FreeSWITCH支持32位及64位的Linux、
 MacOSX、BSD、Solaris、Windows等众多平台。某些平台上有编译好的安装包，但本人强烈建议从源代码进行安装，因为 
FreeSWITCH 
更新非常快，而已编译好的版本通常都比较旧。你可以下载源码包，也可以直接从SVN仓库中取得最新的代码。与其它项目不同的是，其SVN主干
(trunk)代码通常比稳定的发布版更稳定。而且，当你需要技术支持时，开发人员也通常建议你先升级到SVN中最新的代码，再看是不是仍有问题。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
Windows用户可以直接下载安装文件 
http://files.freeswitch.org/windows_installer/freeswitch-1.0.4.exe 
（再提醒一下，版本比较旧代，如果从源代码安装的话，需要Visual Studio 2008）。安装完成执行 
c:\freeswitch\freeswitch.exe 便可启动，其配置文件都在c:\freeswitch\conf\。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以下假定你使用 Linux 平台，并假定你有 Linux 的基本知识。如何从头安装 Linux 
超出了本书的范围，而且，你也可以很容易的从网上找到这里资料。一般来说，任何发行套件都是可以的，但是，有些发行套件的内核、文件系统、编译环
境，LibC 版本会有一些问题。所以，如果你在遇到问题后想获得社区支持，最好选择一种大家都熟悉的发行套件。FreeSWITCH 
开发者使用的平台是 CentOS 5.2/5.3（CentOS 5.4 上会有一些问题，并不总是版本越高越好），社区中也有许多人在使用 
Ubuntu 和
 Debian，如果你想用于生产环境，建议使用 LTS（Long Term Support） 的版本，即 Ubuntu8.04/10.04 或 
Debian Stable。在安装之前，我们需要先准备一些环境(FreeSWITCH 可以以普通用户权限运行，但为了简单起见，以下所有操作均用 
root 执行）：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
CentOS:</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
yum install -y subversion autoconf automake libtool gcc-c++ ncurses-devel make</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
Ubuntu:</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
apt-get -y install build-essential subversion automake autoconf wget libtool libncurses5-dev</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以下三种安装方式任选其一，默认安装位置在/usr/local/freeswitch。安装过程中会下载源代码目录，请保留，以便以后升级及安装配置其它组件。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
解压缩源码包安装:</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
wget http://latest.freeswitch.org/freeswitch-1.0.5-latest.tar.gz<br>
tar xvzf freeswitch-1.0.5-latest.tar.gz<br>
cd freeswitch-1.0.5<br>
./configure<br>
make install</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
这是在在 Linux 上从源代码安装软件的标准过程。首先第 1 行下载最新的源代码，第 2 行解压缩，第 4 行配置编译环境，第 5 行编译安装。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
从 SVN 仓库安装：<br>
FreeSWITCH 使用 Subversion 管理源代码，从代码库安装能让你永远使用最新的版本。</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
svn co http://svn.freeswitch.org/svn/freeswitch/trunk freeswitch</p>
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
cd freeswitch<br>
./bootstrap.sh<br>
./configure<br>
make install</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
与上一种方法不同的是，直接从代码库安装需要执行一个 bootstrap.sh 以初始化一些环境。</p>
<h3 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
最快安装（推荐）</h3>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
wget http://www.freeswitch.org/eg/Makefile &amp;&amp; make install</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以上命令会下载一个 Makefile，然后使用 make 执行安装过程。安装过程中它会从 SVN 仓库中获取代码，实际上执行的操作跟上一种安装方式相同。</p>
<h3 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
安装声音文件</h3>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
在以下例子中我们需要一些声音文件，而安装这些声音文件也异常简单。你只需在源代码目录中执行：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
make sounds-install<br>
make moh-install</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以下高质量的声音文件可选择安装。FreeSWITCH支持8、16、32及48kHz的语音，很少有其它电话系统支持如此多的抽样频率（普通电话是8K，更高频率意味着更好的通话质量）。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
make cd-sounds-install<br>
make cd-moh-install</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
安装完成后，会显示一个有用的帮助，</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
+———- FreeSWITCH install Complete ———-+<br>
+ FreeSWITCH has been successfully installed. +<br>
+ +<br>
+ Install sounds: +<br>
+ (uhd-sounds includes hd-sounds, sounds) +<br>
+ (hd-sounds includes sounds) +<br>
+ ———————————— +<br>
+ make cd-sounds-install +<br>
+ make cd-moh-install +<br>
+ +<br>
+ make uhd-sounds-install +<br>
+ make uhd-moh-install +<br>
+ +<br>
+ make hd-sounds-install +<br>
+ make hd-moh-install +<br>
+ +<br>
+ make sounds-install +<br>
+ make moh-install +<br>
+ +<br>
+ Install non english sounds: +<br>
+ replace XX with language +<br>
+ (ru : Russian) +<br>
+ ———————————— +<br>
+ make cd-sounds-XX-install +<br>
+ make uhd-sounds-XX-install +<br>
+ make hd-sounds-XX-install +<br>
+ make sounds-XX-install +<br>
+ +<br>
+ Upgrade to latest: +<br>
+ ———————————- +<br>
+ make current +<br>
+ +<br>
+ Rebuild all: +<br>
+ ———————————- +<br>
+ make sure +<br>
+ +<br>
+ Install/Re-install default config: +<br>
+ ———————————- +<br>
+ make samples +<br>
+ +<br>
+ Additional resources: +<br>
+ ———————————- +<br>
+ http://www.freeswitch.org +<br>
+ http://wiki.freeswitch.org +<br>
+ http://jira.freeswitch.org +<br>
+ http://lists.freeswitch.org +<br>
+ +<br>
+ irc.freenode.net / #freeswitch +<br>
+————————————————-+</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
至此，已经安装完了。在Unix类操作系统上，其默认的安装位置是/usr/local/freeswtich，下文所述的路径全部相对于该路径。两个常
用的命令是 bin/freeswitch 和 bin/fs_cli，为了便于使用，建议将这两个命令做符号链接放到你的搜索路径中，如：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
ln -sf /usr/local/freeswitch/bin/freeswitch /usr/local/bin/<br>
ln -sf /usr/local/freeswitch/bin/fs_cli /usr/local/bin/</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
当然，如果 /usr/local/bin 不在你的搜索路径中，可以把上面 /usr/local/bin 换成 /usr/bin/。 另外你也可以修改你的PATH环境变量以包含该路径。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
接下来就应该可以启动了，通过在终端中执行freeswitch命令(如果你已做符号链接的话，否则要执行/usr/local/freeswitch
/bin/freeswitch)可以将其启动到前台，启动过程中会有许多log输出，第一次启动时会有一些错误和警告，可以不用理会。启动完成后会进入
到系统控制台(以下称称FS-Con)。并显示类似的提示符“freeswitch@internal&gt;”(以下简作 “FS&gt; 
”)。通过在FS-Con中输入shutdown命令可以关闭FreeSWITCH。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果您想将FreeSWITCH启动到后台(daemon，服务模式)，可以使用freeswitch -nc (No 
console)。后台模式没有控制台，如果这时想控制FreeSWITCH，可以使用客户端软件fs_cli连接。注意，在fs_cli中需要使用 
fsctl shutdown 命令关闭 FreeSWITCH。当然，也可以直接在 Linux 提示符下通过 freeswitch -stop 
命令关闭。如果不想退出 FreeSWITCH 服务，只退出fs_cli客户端，则需要输入 /exit，或Ctrl +
 D，或者，直接关掉终端窗口。</p>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
连接SIP软电话</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
FreeSWITCH最典型的应用是作为一个服务器(它实际上是一个背靠背的用户代理，B2BUA)，并用电话客户端软件（一般叫软电话）连接到它。虽然
 FreeSWITCH 支持 IAX、H323、Skype、Gtalk 等众多通信协议，但其最主要的协议还是 
SIP。支持SIP的软电话有很多，最常用的是 X-Lite 和 Zoiper。这两款软电话都支持 Linux、MacOSX 和 
Windows平台，免费使用但是不开源。在 Linux 上你还可以使用 ekiga 软电话。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
强烈建议在同一局域网上的其它机器上安装软电话，并确保麦克风和耳机可以正常工作 
。当然，如果你没有多余的机器做这个实验，那么你也可以在同一台机器上安装。只是需要注意，软电话不要占用 UDP 5060 端口，因为 
FreeSWITCH 默认要使用该端口，这是新手常会遇到的一个问题。你可以通过先启动 FreeSWITCH 
再启动软电话来避免该问题，另外有些软电话允许你修改本地监听端口。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
通过输入以下命令可以知道 FreeSWITCH 监听在哪个IP地址上，记住这个 IP 地址(:5060以前的部分)，下面要用到：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
netstat -an | grep 5060<br>
FreeSWITCH 默认配置了 1000 ~ 1019 共 20 个用户，你可以随便选择一个用户进行配置：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
在 X-Lite 上点右键，选 Sip Account Settings…，点Add添加一个账号，填入以下参数(Zoiper 可参照配置)：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
Display Name: 1000<br>
User name: 1000<br>
Password: 1234<br>
Authorization user name: 1000<br>
Domain: 你的IP地址，就是刚才你记住的那个</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
其它都使用默认设置，点 OK 就可以了。然后点 Close 关闭 Sip Account 设置窗口。这时 X-Lite 将自动向 
FreeSWITCH 注册。注册成功后会显示”Ready. Your username is 
1000″，另外，左侧的“拨打电话”（Dial）按钮会变成绿色的。如下图。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
激动人心的时刻就要来了。输入“9999”按回车（或按绿色拨打电话按钮），就应该能听到保持音乐(MOH, Music on 
Hold)。如果听不到也不要气馁，看一下 FS-Con 中有没有提示什么错误。如果有“File Not 
Found”之类的提示，多半是声音文件没有安装，重新查看 make moh-install 是否有错误。接下来，可以依次试试拨打以下号码：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
——————<br>
号码 | 说明<br>
———————-<br>
9999 | 保持音乐<br>
9996 | echo，回音测试<br>
9992 | info，在控制台上显示呼叫参数<br>
9888 | FreeSWITCH电话会议，每周召开<br>
5900 | 呼叫挂起<br>
5901 | 接听挂起的呼叫<br>
5000 | 示例IVR<br>
4000 | 听取语音信箱<br>
33xx | 电话会议，48K(其中xx可为00-99，下同)<br>
32xx | 电话会议，32K<br>
31xx | 电话会议，16K<br>
30xx | 电话会议，8K<br>
2000-2002 | 呼叫组<br>
1000-1019 | 默认分机号</p>
</blockquote>
<h3 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
表一： 默认号码及说明</h3>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
另外，也许你想尝试注册另外一个SIP用户并在两者间通话。最好是在同一个局域网中的另外一台机器上启动另一个 X-Lite ，并使用 1001 
注册，注册完毕后就可以在 1000 上呼叫 1001，或在 1001 上呼叫 1000 
。当然，你仍然可以在同一台机器上做这件事（比方说用Zoiper注册为1001），需要注意的是，由于你机器上只有一个声卡，两者可能会争用声音设备。
特别是在Linux上，有些软件会独占声音设备。如果同时也有一个USB接口的耳机，那就可以设置不同的软件使用不同的声音设备。</p>
<h3 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
配置简介</h3>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
FreeSWITCH配置文件默认放在 conf/， 它由一系列XML配置文件组成。最顶层的文件是freeswitch.xml，系统启动时它依次装入其它一些XML文件并最终组成一个大的XML文件。</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153); font-family:宋体">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
文件 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 说明<br>
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－<br>
vars.xml &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 一些常用变量<br>
dialplan/default.xml &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 缺省的拨号计划<br>
directory/default/*.xml &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | SIP用户，每用户一个文件<br>
sip_profiles/internal.xml &nbsp; &nbsp; &nbsp; &nbsp; | 一个SIP profile，或称作一个SIP-UA，监听在本地IP及端口5060，一般供内网用户使用<br>
sip_profiles/externa.xml &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 另一个SIP-UA，用作外部连接，端口5080<br>
autoload_configs/modules.conf.xml | 配置当FreeSWITCH启动时自动装载哪些模块</p>
</blockquote>
<h3 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
添加一个新的SIP用户</h3>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
FreeSWITCH默认设置了20个用户(1000-1019)，如果你需要更多的用户，或者想通过添加一个用户来学习FreeSWITCH配置，只需要简单执行以下三步：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
在 conf/directory/default/ 增加一个用户配置文件<br>
修改拨号计划(Dialplan)使其它用户可以呼叫到它<br>
重新加载配置使其生效<br>
如果想添加用户Jack，分机号是1234。只需要到 conf/directory/default 目录下，将 1000.xml 拷贝到 
1234.xml。打开1234.xml，将所有1000都改为1234。并把 effective_caller_id_name 的值改为 
Jack，然后存盘退出。如：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
接下来，打开 conf/dialplan/default.xml，找到 
一行，改为。熟悉正则表达式的人应该知道，“^(10[01][0-9])$”匹配被叫号码1000-1019。因此我们修改之后的表达式就多匹配了一个
1234。FreeSWITCH使用Perl兼容的正则表达式(PCRE)。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
现在，回到FS-Con，或启动fs_cli，执行 reloadxml 命令或按快捷键F6，使新的配置生效。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
找到刚才注册为1001的那个软电话(或启动一个新的，如果你有足够的机器的话)，把1001都改为1234然后重新注册，则可以与1000相互进行拨打
测试了。如果没有多台机器，在同一台机器上运行多个软电话可能有冲突，这时，也可以直接进在FreeSWITCH控制台上使用命令进行测试：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; sofia status profile internal (显示多少用户已注册）<br>
FS&gt; originate sofia/profile/internal/1000 &amp;echo (拨打1000并执行echo程序）<br>
FS&gt; originate user/1000 &amp;echo (同上）<br>
FS&gt; originate sofia/profile/internal/1000 9999 (相当于在软电话1000上拨打9999)<br>
FS&gt; originate sofia/profile/internal/1000 9999 XML default (同上)</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
其中，echo() 程序一个很简单的程序，它只是将你说话的内容原样再放给你听，在测试时很有用，在本书中，我们会经常用它来测试。</p>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
FreeSWITCH用作软电话</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
FreeSWITCH也可以简单的用作一个软电话，如X-Lite. 虽然相比而言比配置X-Lite略微麻烦一些，但你会从中得到更多好处：FreeSWITCH是开源的，更强大、灵活。关键是它是目前我所知道的唯一支持CELT高清通话的软电话。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
FreeSWITCH使用mod_portaudio支持你本地的声音设备。该模块默认是不编译的。到你的源代码树下，执行：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
make mod_portaudio<br>
make mod_portaudio-install</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
其它的模块也可以依照上面的方式进行重新编译和安装。然后到FS-Con中，执行:</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; load mod_portaudio</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果得到“Cannot find an input device”之类的错误可能是你的声卡驱动有问题。如果是提示“+OK”就是成功了，接着执行：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; pa devlist</p>
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
API CALL [pa(devlist)] output:<br>
0;Built-in Microphone;2;0;<br>
1;Built-in Speaker;0;2;r<br>
2;Built-in Headphone;0;2;<br>
3;Logitech USB Headset;0;2;o<br>
4;Logitech USB Headset;1;0;i</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以上是在我笔记本上的输出，它列出了所有的声音设备。其中，3和4最后的“o”和“i”分别代表声音输出(out)和输入(in)设备。在你的电脑上可能不一样，如果你想选择其它设备，可以使用命令：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; pa indev #0<br>
FS&gt; pa outdev #2</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以上命令会选择我电脑上内置的麦克风和耳机。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
接下来你就可以有一个可以用命令行控制的软电话了，酷吧？</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; pa looptest (回路测试，echo)<br>
FS&gt; pa call 9999<br>
FS&gt; pa call 1000<br>
FS&gt; pa hangup</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如上所示，你可以呼叫刚才试过的所有号码。现在假设想从SIP分机1000呼叫到你，那需要修改拨号计划(Dialplan)。用你喜欢的编辑器编辑以下文件放到conf/dialplan/default/portaudio.xml</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
然后，在FS-Con中按“F6”或输入以下命令使之生效：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; reloadxml</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
在分机1000上呼叫“me”或“12345678”(你肯定想为自己选择一个更酷的号码)，然后在FS-Con上应该能看到类似“[DEBUG] 
mod_portaudio.c:268 BRRRRING! BRRRRING! call 
1”的输出（如果看不到的话按“F8”能得到详细的Log），这说明你的软电话在振铃。多打几个回车，然后输入“pa 
answer”就可以接听电话了。“pa hangup”可以挂断电话。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
当然，你肯定希望在振铃时能听到真正的振铃音而不是看什么BRRRRRING。好办，选择一个好听一声音文件(.wav格式)，编辑conf/autoload_configs/portaudio.conf.xml，修改下面一行：</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
然后重新加载模块：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; reloadxml<br>
FS&gt; reload mod_portaudio</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
再打打试试，看是否能听到振铃音了？</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果你用不惯字符界面，可以看一下FreeSWITCH-Air(http://www.freeswitch.org.cn/download)，它为
 FreeSWITCH 
提供一个简洁的软电话的图形界面。另外，如果你需要高清通话，除需要设置相关的语音编解码器(codec)外，你还需要有一幅好的耳机才能达到最好的效
果。本人使用的是一款USB耳机。</p>
<h3 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
配置SIP网关拨打外部电话</h3>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果你在某个运营商拥有SIP账号，你就可以配置上拨打外部电话了。该SIP账号（或提供该账号的设备）在 FreeSWITCH 
中称为SIP网关（Gateway）。添加一个网关只需要在 conf/sip_profiles/external/ 
创建一个XML文件，名字可以随便起，如gw1.xml。</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果你的SIP网关还需要其它参数，可以参阅同目录下的 example.xml，但一般来说上述参数就够了。你可以重启 FreeSWITCH，或者执行以下命令使用之生效。</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; sofia profile external rescan reloadxml</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
然后显示一下状态：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; sofia status</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果显示 gateway gw1 的状态是 REGED ，则表明正确的注册到了网关上。你可以先用命令试一下网关是否工作正常：</p>
<blockquote style="padding-top:2px; padding-right:10px; padding-bottom:2px; padding-left:10px; background-color:rgb(241,245,251); margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; color:rgb(51,102,153)">
<p style="padding-top:5px; padding-bottom:5px; font-size:1em; margin-top:5px; margin-bottom:5px; line-height:20px">
FS&gt; originate sofia/gateway/gw1/xxxxxx &amp;echo()</p>
</blockquote>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
以上命令会通过网关 gw1 呼叫号码 xxxxxx（可能是你的手机号），被叫号码接听电话后，FreeSWITCH 会执行 echo() 程序，你应该能听到自己的回音。</p>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
从某一分机上呼出</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果网关测试正常，你就可以配置从你的SIP软电话或portaudio呼出了。由于我们是把 FreeSWITCH 当作 PBX 
用，我们需要选一个出局字冠。常见的 PBX 一般是内部拨小号，打外部电话就需要加拨 0 或先拨 9 
。当然，这是你自己的交换机，你可以用任何你喜欢的数字（甚至是字母）。 继续修改拨号计划，创建新XML文件： 
conf/dialplan/default/call_out.xml :</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
其中，(\d+)为正则表达式，匹配 0 后面的所有数字并存到变量 $1 中。然后通过 bridge 程序通过网关 gw1 打出该号码。当然，建立该XML后需要在Fs-Con中执行 reloadxml 使用之生效。</p>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
呼入电话处理</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
如果你的 SIP 网关支持呼入，那么你需要知道呼入的 DID 。 DID的全称是 Direct Inbound 
Dial，即直接呼入。一般来说，呼入的 DID 就是你的 SIP 号码，如果你不知道，也没关系，后面你会学会如何得到。 编辑以下XML文件放到 
conf/dialplan/public/my_did.xml</p>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
reloadxml 使之生效。上述配置会将来话直接转接到分机 1000 上。在后面的章节你会学到如何更灵活的处理呼入电话，如转接到语音菜单或语音信箱等。</p>
<h2 style="font-family:'Microsoft YaHei',Tahoma,Helvetica,sans-serif; color:rgb(0,0,0)">
小结</h2>
<p style="padding-top:0.5em; padding-bottom:0.8em; color:rgb(0,0,0); font-size:1em; margin-top:0px; margin-bottom:0px; line-height:24px">
其实本章涵盖了从安装、配置到调试、使用的相当多的内容，如果你能顺利走到这儿，你肯定对 FreeSWITCH 
已经受不释手了。如果你卡在了某处，或某些功能未能实现，也不是你的错，主要是因为 FreeSWITCH 
博大精深，我不能在短短的一章内把所有的方面解释清楚。在后面的章节中，你会学到更多的基本概念、更加深入地了解 FreeSWITCH 
的哲学，学到更多的调试技术和技巧，解决任何问题都会是小菜一碟了。</p>
</div>

</div>
<div class="share_buttons" id="sharePanel"><span>分享到：</span> <a name="sina" class="share_sina" title="分享到新浪微博"></a><a name="qq" class="share_qq" title="分享到腾讯微博"></a></div>

<div class="article_next_prev">
        <li class="prev_article">
            <span>上一篇：</span><a href="http://blog.csdn.net/qq275683555/article/details/7091346">centos 5.4 升级php到5.3的方法</a></li>
</div>


</div>
<div id="ad_cen"><iframe src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ad.htm" style="border-width: 0px; overflow: hidden; width: 950px; height: 92px;" id="ad_frm_0" frameborder="0" scrolling="no"></iframe></div>
<script type="text/javascript">
    new Ad(4, 'ad_cen');
</script>
<div id="comment_title" class="panel_head">查看评论<a name="comments"></a></div>
<div id="comment_list"><br>&nbsp;&nbsp;暂无评论<br><br><div class="clear"></div></div>
<div id="comment_bar"></div>
<div id="comment_form"><div class="guest_link">您还没有登录,请<a href="http://passport.csdn.net/account/login?from=http%3A%2F%2Fblog.csdn.net%2Fqq275683555%2Farticle%2Fdetails%2F7092085">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Fqq275683555%2Farticle%2Fdetails%2F7092085">[注册]</a></div></div>
<div class="announce">* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
<script type="text/javascript">
    var fileName = '7092085';
    var commentscount = 0;
    var islock = false
</script>
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/comment.js"></script>
<div id="ad_bot"><iframe src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ad_002.htm" style="border-width: 0px; overflow: hidden; width: 950px; height: 170px;" id="ad_frm_1" frameborder="0" scrolling="no"></iframe></div>
<script type="text/javascript">
    new Ad(5, 'ad_bot');
</script>
<div id="report_dialog"></div>


<div class="clear"></div>
</div>
</div>
<div id="side">
    <div class="side">
<div id="panel_Profile" class="panel">
    <ul class="panel_head"><span>个人资料</span></ul>
    <ul class="panel_body profile">
        <div id="blog_userface">
            <a href="http://my.csdn.net/qq275683555" target="_blank">
            <img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/1_qq275683555.gif" title="访问我的空间" style="max-width: 90%;">
            </a>
            <br>
            <span><a href="http://my.csdn.net/qq275683555" target="_blank">qq275683555</a></span>
        </div>
<div class="interact">
<!--<a href="#" class="attented" title="已关注"></a>-->
<a href="#" class="attent" id="span_add_follow" title="[加关注]"></a>
<a href="http://my.csdn.net/my/letter/send/qq275683555" class="letter" title="[发私信]"></a>
</div>
        <div id="blog_medal">
        </div>
        <ul id="blog_rank">
            <li>访问：<span>323次</span></li>
            <li>积分：<span>15分</span></li>
            <li>排名：<span>千里之外</span></li>
        </ul>
        <ul id="blog_statistics">
            <li>原创：<span>1篇</span></li>
            <li>转载：<span>1篇</span></li>
            <li>译文：<span>0篇</span></li>
            <li>评论：<span>0条</span></li>
        </ul>
    </ul>
</div>

<script type="text/javascript">
var _blogger='qq275683555';
$(document).ready(function () {
    $('#span_add_follow').click(function () {
        var url = "http://my.csdn.net/index.php/follow/do_follow?jsonpcallback=?";
        $.getJSON(url, { "username": _blogger }, function (data) {
            if (data.succ == 1) {
                alert('关注成功！');
                $('#span_add_follow').attr('class', 'attented').click(function () { return false; });
            } else {
                alert(data.msg);
            }
        });
    });
    if (getUN().toLowerCase() == _blogger.toLowerCase()) {
        $('.interact').hide();
    }
});
function getUN() {
    var m = document.cookie.match(new RegExp("(^| )UserName=([^;]*)(;|$)"));
    if (m) return m[2];
    else return '';
}
</script>

<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" class="blogsearch" title="请输入关键字" type="text"></span>
        <input id="btnSubmit" value="搜索" title="search in blog" type="submit">
        <input name="q" id="inputQ" type="hidden">
        <input name="t" value="blog" type="hidden">
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div><div id="panel_Category" class="panel">
    <ul class="panel_head"><span>文章分类</span></ul>
    <ul class="panel_body">
        <li>
        <a href="http://blog.csdn.net/qq275683555/article/category/956906">android</a><span>(0)</span>
        
        </li>
        <li>
        <a href="http://blog.csdn.net/qq275683555/article/category/956907">centos</a><span>(0)</span>
        
        </li>
        <li>
        <a href="http://blog.csdn.net/qq275683555/article/category/956908">php</a><span>(1)</span>
        
        </li>
        <li>
        <a href="http://blog.csdn.net/qq275683555/article/category/956909">mysql</a><span>(0)</span>
        
        </li>
        <li>
        <a href="http://blog.csdn.net/qq275683555/article/category/956910">freeswitch</a><span>(1)</span>
        
        </li>
    </ul>
</div><div id="panel_Archive" class="panel">
    <ul class="panel_head"><span>文章存档</span></ul>
    <ul class="panel_body">
        <div id="archive_list">
        <!--归档统计-->
        <li><a href="http://blog.csdn.net/qq275683555/article/month/2011/12">2011年12月</a>(2)</li>
        </div>
    </ul>
</div>
<div id="hotarticls" class="panel">
    <ul class="panel_head"><span>阅读排行</span></ul>
    <ul class="panel_body">
        <li>
            <a href="http://blog.csdn.net/qq275683555/article/details/7092085" title="FreeSWITCH 初步">FreeSWITCH 初步</a> (204)
        </li>
        <li>
            <a href="http://blog.csdn.net/qq275683555/article/details/7091346" title="centos 5.4 升级php到5.3的方法">centos 5.4 升级php到5.3...</a> (21)
        </li>
    </ul>
</div>
<div id="hotarticls" class="panel">
    <ul class="panel_head"><span>评论排行</span></ul>
    <ul class="panel_body">
        <li>
            <a href="http://blog.csdn.net/qq275683555/article/details/7091346" title="centos 5.4 升级php到5.3的方法">centos 5.4 升级php到5.3...</a> (0)
        </li>
        <li>
            <a href="http://blog.csdn.net/qq275683555/article/details/7092085" title="FreeSWITCH 初步">FreeSWITCH 初步</a> (0)
        </li>
    </ul>
</div>
<div id="homepageArticles" class="panel">
    <ul class="panel_head"><span>推荐文章</span></ul>
    <ul class="panel_body" id="ad_commend"><iframe src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ad_003.htm" style="border-width: 0px; overflow: hidden; width: 194px; height: 200px;" id="ad_frm_2" frameborder="0" scrolling="no"></iframe></ul>
</div>
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ad.js"></script>
<script type="text/javascript">
    new Ad(12, 'ad_commend');
</script>    </div>
    <div class="clear">
    </div>
</div>

<div class="clear"></div>
</div>
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/shCore-src.js"></script>
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ZeroClipboard.js"></script>
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/article_code.js"></script>

<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/show.js"></script>
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/showblogmedal.xml"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/pv.xml" border="0" height="0" width="0">
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/counter.js"></script><script type="text/javascript" charset="UTF-8" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/msg.js"></script><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/visitlog" alt="" border="0" height="1" width="1">
<script type="text/javascript" src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/publib_footer.js"></script><link rel="stylesheet" type="text/css" href="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/pub_footer_2012.css"><div class="pub_footerall"><dl><dt></dt> <dd><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a>|<a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a>|<a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a>|<a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a>|<a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a>|<a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a>|<a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a>|<a href="mailto:webmaster@csdn.net">问题报告</a></dd><dd>京&nbsp;ICP&nbsp;证&nbsp;070598&nbsp;号</dd><dd>北京创新乐知信息技术有限公司 版权所有</dd><dd><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/ico_email.gif" alt="" title=""> 联系邮箱：webmaster@csdn.net</dd><dd>Copyright © 1999-2012, CSDN.NET, All Rights Reserved&nbsp;<a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="FreeSWITCH%20%E5%88%9D%E6%AD%A5_files/gongshang_logos.gif" alt="GongshangLogo" title=""></a></dd></dl></div>




</div>

</body></html>