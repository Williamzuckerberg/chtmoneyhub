<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN">
<html><head>
       <meta http-equiv="Content-Type" content="text/html; charset=gbk">
       <meta content="最近我在做一个项目，主要是涉及androidHDMI接口显示720P视频，现在HDMI和开发板屏幕同步播放视频正常，但是现在需要实现HDMI接口正常播放视频，而开发板上不同步显示视频，或者说背景播放视频，目前主要是在考虑overlay的叠加机制，可是一直再搞overlay的测试代码最后获取的地址始终为0！！首先请教下高手，有没有什么可行性方案！另外overlay代码的实现机制到底是不是需要大量修改..." name="Description">
       <title>一哥技术馆 关于android通过HDMI接口双屏显示不同内容问题！高分 - 移动平台 / Android - 移动平台开发</title>
        <meta name="keywords" content=",移动平台开发">
        <script type="text/javascript" src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/common.js"></script>
        <link href="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/main.css" rel="stylesheet" type="text/css">
		<style type="text/css">
		<!--
 		.tabmenu li{list-style-type:none;display:inline;width:110px;float:left;border:1px dotted #6293BB;margin:2px 4px;padding-left:4px}
		.fstli li a{color:#fff}
			
		//-->
		</style>

    </head>
    <body>
        <div class="mb">
            <div id="head" style="margin:0 0 6px 0">
                <table align="center" border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tbody><tr>
                        <td width="85"><a href="http://www.hbflzdc.com/"><img src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/logo.gif" alt="全球IT存档" border="0"></a></td>

                        <td align="left"><b><font size="3">一哥技术馆-IT存档</font></b><br>全球IT存档，高质量的开发者资料图书馆</td>
                        <td align="right"> 
							</td>
                        <td align="right" valign="bottom" width="170">
                           
                        </td>
                    </tr>
                </tbody></table>
			</div>


			 <!--Start of the Tabmenu1 -->

 				<ul class="tabmenu">
 					<li><a href="http://www.hbflzdc.com/">首页</a></li>
					<li><a href="http://dotnet.hbflzdc.com/">DotNET论坛</a></li>
					<li><a href="http://java.hbflzdc.com/">Java论坛</a></li>
					<li><a href="http://webdevelop.hbflzdc.com/">WEB论坛</a></li>
					<li><a href="http://php.hbflzdc.com/">PHP专区</a></li>
					<li><a href="http://mssql.hbflzdc.com/">SQLServer</a></li>
					<li><a href="http://vc.hbflzdc.com/">VC/MFC论坛</a></li>
					<li><a href="http://vb.hbflzdc.com/">VB开发论坛</a></li>
					<li><a href="http://delphi.hbflzdc.com/">Delphi论坛</a></li>
					<li><a href="http://bcb.hbflzdc.com/">C++ Builder</a></li>
					<li><a href="http://cpp.hbflzdc.com/">C/C++</a></li>
					<li><a href="http://powerbuilder.hbflzdc.com/">PowerBuilder</a></li>
					<li><a href="http://oracle.hbflzdc.com/">Oracle论坛</a></li>
					<li><a href="http://embedded.hbflzdc.com/">硬件/嵌入开发</a></li>
					<li><a href="http://mobile.hbflzdc.com/">移动开发论坛</a></li>
					<li><a href="http://windows.hbflzdc.com/">windows专区</a></li>
					<li><a href="http://mediandflash.hbflzdc.com/">多媒体论坛</a></li>
					<li><a href="http://mysqlpostgresql.hbflzdc.com/">MYSQL/Postgresql</a></li>
					<li><a href="http://hpdatabase.hbflzdc.com/">高级数据开发</a></li>
					<li><a href="http://other.hbflzdc.com/">水区</a></li>
					<li><a href="http://www.hbflzdc.com/tags">热门标签</a></li>
 				</ul>
 
        </div>


        &nbsp;<br>
        <div class="mb c">
            <div class="bl">
                <div class="tt"> <h1>关于android通过HDMI接口双屏显示不同内容问题！高分 - 移动平台 / Android</h1> </div>
                <!--  关键字：,移动平台开发-->

                <center> 状态： <font color="red">未解决</font> - 阅读：63 - 提问时间： 2011-04-04 13:11:08 - 引源：CSDN论坛 - 校对：[女]<br>
				关键字：,移动平台开发				</center>
				<!--  关于android通过HDMI接口双屏显示不同内容问题！高分 - 移动平台 / Android  正文-->
				<div style="float:right;width:300px;"><script type="text/javascript" src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/g2.htm"></script></div>
                <div id="ask">    最近我在做一个项目，主要是涉及android HDMI接口显示720P视频，现在HDMI和开发板屏幕同步播放视频正常，<br><br>但是现在需要实现HDMI接口正常播放视频，而开发板上不同步显示视频，或者说背景播放视频，目前主要是在考虑overlay的叠加机制，可是一直再搞overlay的测试代码最后获取的地址始终为0！！<br><br> &nbsp;   首先请教下高手，有没有什么可行性方案！<br>另外overlay代码的实现机制到底是不是需要大量修改代码，还是我只要写测试程序就可以实现了？因为我看原先的代码硬件抽象层的overlay根本没调。<br><dl class="code"><dt>C/C++ code</dt><dd><pre><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #0000FF;">int</span><span style="color: #000000;"> main(</span><span style="color: #0000FF;">int</span><span style="color: #000000;"> argc, </span><span style="color: #0000FF;">char</span><span style="color: #000000;">**</span><span style="color: #000000;"> argv)
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> set up the thread-pool</span><span style="color: #008000;">
</span><span style="color: #000000;">    sp</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">ProcessState</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> proc(ProcessState::self());  </span><span style="color: #008000;">//</span><span style="color: #008000;">这两句一加就报错！！所以去掉了</span><span style="color: #008000;">
</span><span style="color: #000000;">    ProcessState::self()</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">startThreadPool();      </span><span style="color: #008000;">//</span><span style="color: #008000;">这两句一加就报错！！

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> create a client to surfaceflinger</span><span style="color: #008000;">
</span><span style="color: #000000;">    sp</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">SurfaceComposerClient</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> client </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> SurfaceComposerClient();
    
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> create pushbuffer surface</span><span style="color: #008000;">
</span><span style="color: #000000;">    sp</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Surface</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> surface </span><span style="color: #000000;">=</span><span style="color: #000000;"> client</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">createSurface(getpid(), </span><span style="color: #800080;">0</span><span style="color: #000000;">, </span><span style="color: #800080;">320</span><span style="color: #000000;">, </span><span style="color: #800080;">240</span><span style="color: #000000;">,    
            PIXEL_FORMAT_UNKNOWN, ISurfaceComposer::ePushBuffers);  </span><span style="color: #008000;">//</span><span style="color: #008000;">这里后来改成了SurfaceControl，
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 再在这个类中获得surface！其他代码都没动

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> get to the isurface</span><span style="color: #008000;">
</span><span style="color: #000000;">    sp</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">ISurface</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> isurface </span><span style="color: #000000;">=</span><span style="color: #000000;"> Test::getISurface(surface);
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">isurface = %p\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, isurface.</span><span style="color: #0000FF;">get</span><span style="color: #000000;">());
    
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> now request an overlay</span><span style="color: #008000;">
</span><span style="color: #000000;">    sp</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">OverlayRef</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #0000FF;">ref</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> isurface</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">createOverlay(</span><span style="color: #800080;">320</span><span style="color: #000000;">, </span><span style="color: #800080;">240</span><span style="color: #000000;">, PIXEL_FORMAT_RGB_565);
    sp</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Overlay</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> overlay </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Overlay(</span><span style="color: #0000FF;">ref</span><span style="color: #000000;">);
    

    </span><span style="color: #008000;">/*</span><span style="color: #008000;">
     * here we can use the overlay API 
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    
    overlay_buffer_t buffer; 
    overlay</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">dequeueBuffer(</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">buffer);
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">buffer = %p\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, buffer);
    
    </span><span style="color: #0000FF;">void</span><span style="color: #000000;">*</span><span style="color: #000000;"> address </span><span style="color: #000000;">=</span><span style="color: #000000;"> overlay</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">getBufferAddress(buffer);
</span><span style="color: #008000;">//</span><span style="color: #008000;">buffer有值，下面获得address就为零了！！</span><span style="color: #008000;">
</span><span style="color: #000000;">    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">address = %p\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, address);

    overlay</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">queueBuffer(buffer);
</span><span style="color: #008000;">/*</span><span style="color: #008000;">第一个参数判断OVERLAY_DITHER = 3 震动？，值为4 即OVERLAY_TRANSFORM，则判断第二个参数，第二个参数为旋转的角度</span><span style="color: #008000;">*/</span><span style="color: #000000;">
    overlay</span><span style="color: #000000;">-&gt;</span><span style="color: #000000;">setParameter(</span><span style="color: #800080;">3</span><span style="color: #000000;">,</span><span style="color: #800080;">10</span><span style="color: #000000;">);

    </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></div>
</pre></dd></dl><br><br><br>源码是2.1的源码，请教下高手！！！最近做的很郁闷，也很急，希望能给予我一些帮助。深表感谢。<br><br>最近又在考虑通过视频播放  不把视频送到主屏上，而直接送到HDMI接口上的屏幕上，但是只是有点想法，没啥好的思路！！！</div>

<div class="ans"><div class="anser"><span class="userava">yiyaaixuexi</span>  Replied at : 2011-04-04 22:12:00</div><div class="rbody">http://apps.hi.baidu.com/share/detail/30206630<br>Android上HDMI介绍</div></div>
<div class="ans"><div class="anser"><span class="userava">robinyeung</span>  Replied at : 2011-04-04 23:17:59</div><div class="rbody"><div><fieldset><legend>引用 1 楼 yiyaaixuexi 的回复:</legend><br>http://apps.hi.baidu.com/share/detail/30206630<br>Android上HDMI介绍<br></fieldset></div><br><br>那个测试代码是不是根本就没试过，有问题的！！！！<br><br>那个文章我早看过啦！！</div></div>
<div class="ans"><div class="anser"><span class="userava">l13873666736</span>  Replied at : 2011-04-07 10:21:55</div><div class="rbody">高手，关注，如果可以那VOD的实现又有新方式。</div></div>
<div class="ans"><div class="anser"><span class="userava">OExpress</span>  Replied at : 2011-04-07 13:32:09</div><div class="rbody">这个因该需要顶层驱动支持才行，帮顶</div></div>
<div class="ans"><div class="anser"><span class="userava">yelwen000</span>  Replied at : 2011-08-22 09:56:52</div><div class="rbody">楼主是如何检测Android HDMI 和 其他HDMI 设备连接啊？求指点。顶上</div></div>
<div class="ans"><div class="anser"><span class="userava">myg_315</span>  Replied at : 2012-02-10 19:43:54</div><div class="rbody">同求和5楼一样的问题，谢谢。</div></div>
<div class="ans"><div class="anser"><span class="userava">myg_315</span>  Replied at : 2012-02-10 19:44:40</div><div class="rbody"><div><fieldset><legend>引用 5 楼 yelwen000 的回复:</legend><br><br>楼主是如何检测Android HDMI 和 其他HDMI 设备连接啊？求指点。顶上<br></fieldset></div><br>yelwen000，指点一下这个问题吧？谢谢</div></div>
<div class="ans"><div class="anser"><span class="userava">zhang19871112</span>  Replied at : 2012-03-05 16:13:27</div><div class="rbody"><div><fieldset><legend>引用 5 楼 yelwen000 的回复:</legend><br><br>楼主是如何检测Android HDMI 和 其他HDMI 设备连接啊？求指点。顶上<br></fieldset></div><br>HDMI插入有中断产生，产生时发送uevent，android hal层有个东西可以监听uevent事件的，解析出uevent中的相关设备名称就行了</div></div>
                <!--  关于android通过HDMI接口双屏显示不同内容问题！高分 - 移动平台 / Android  END-->
                &nbsp;
                <br>
 				<div style="clear:both"></div>
                <div class="tt"><span class="tt1">相关问题</span></div>


                <div class="ansli">
                    <ul>
                                            </ul>
                </div>

                &nbsp;
                <br>

                <p> </p>&nbsp;
                <div class="tt"><span class="tt1"> - 最新问答</span></div>

                <table align="center" border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tbody><tr><td width="49%">

                            <h5>最新问题</h5>
                            <div class="ansli">
                                <ul>
                                    <li><a href="http://mobile.hbflzdc.com/thread/206828">显示歌词就出错！为什么？ - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206846">怎样在在继承自QGLWidget的程序画出旋转文字 - 移动平台 / Qt开发</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206848">一个android新人的困扰 - 移动平台 / 非技术区</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206851">Android  Battery Level 更新问题 - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206856">http协议高手们，请教一个问题 - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206855">ScrollView 和 OnDraw()的问题 - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206840">求救！如何将百度地图上面的静态marker，设置为动画图片，一闪一闪的？ - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206852">Android NDK开发用的SO库是用什么语言写的？ - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206838">TextView放在ImageView下部(是imageview里面)，大家是怎么做的 - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/206842">QT的emit是啥语法？ - 移动平台 / Qt开发</a></li>
                                </ul>
                            </div>


                        </td>
                        <td></td>

                        <td width="49%">
                            <h5>最近完成的问题</h5>

                            <div class="ansli">
                                <ul>
                                    <li><a href="http://mobile.hbflzdc.com/thread/202165">QT for Android怎样设置静态编译? - 移动平台 / Qt开发</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/202167">塞班系统的MT4外汇交易软件哪儿有啊 - 移动平台 / Symbian</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/202161">安装4.0模拟器的问题,求指点 - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/156775">activity 跳转到mapactivity 报空指针异常 急~~~~~ - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/156783">conbobox中的项目与相应的checkbox连接 - 移动平台 / Qt开发</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/156777">如何在QTreeWidget的最上层文本上增加右键操作 - 移动平台 / Qt开发</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/156784">求qreal数据转化为byte - 移动平台 / Qt开发</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/156807">SAX解析问题 - 移动平台 / Android</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/154988">调用update函数后，paintEvent函数没有执行？ - 移动平台 / Qt开发</a></li>
<li><a href="http://mobile.hbflzdc.com/thread/154983">代码无误，为什么Menu菜单显示不了 - 移动平台 / Android</a></li>
                                </ul>
                            </div>


                        </td>
                    </tr></tbody></table>

            </div>
			

            <div class="br">
                <div class="tt"><span class="tt1">热点标签云</span></div>

                <div></div>

                &nbsp;

                <div class="tt"><span class="tt1">业界新闻资讯</span></div>


                <div class="ansli">
                    <ul>
                                            </ul>
                </div>



            </div>





            <div class="mb">

                <div id="footer">


                    &#169; 2001-2011 hbflzdc.com. All rights reserved.
                    <br>
                    [ 国字备0103076号 ] 
                    <br>
                    <img src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/icon_big_green.gif" alt="百度绿色大联盟" height="68" width="55">

                </div>

            </div>




<div style="display:none">
<script src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/stat.php" language="JavaScript" charset="gb2312"></script><script src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/cnzz_core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=1013104" target="_blank" title="站长统计">站长统计</a>
<script language="javascript" type="text/javascript" src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/1612638.js"></script><a href="http://www.51.la/?1612638" target="_blank"><img alt="51.la 专业、免费、强健的访问统计" src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/icon_9.gif" style="border: medium none;"></a>
<img style="width: 0px; height: 0px;" src="%E5%85%B3%E4%BA%8Eandroid%E9%80%9A%E8%BF%87HDMI%E6%8E%A5%E5%8F%A3%E5%8F%8C%E5%B1%8F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%86%85%E5%AE%B9%E9%97%AE%E9%A2%98_files/go.htm">
</div>


</div></body></html>